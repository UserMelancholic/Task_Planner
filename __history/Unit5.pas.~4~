unit Unit5;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ExtDlgs;

type
  TForm5 = class(TForm)
    OpenTextFileDialog1: TOpenTextFileDialog;
    SaveTextFileDialog1: TSaveTextFileDialog;
    Memo1: TMemo;
    Button1: TButton;
    Button2: TButton;
    Button3: TButton;
    Button4: TButton;
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form5: TForm5;

implementation

{$R *.dfm}

// Загрузить файл в Memo1
procedure TForm5.Button1Click(Sender: TObject);
begin
  if FileExists( ExtractFilePath(ParamStr(0))+'Data\TaskList.txt' ) then begin  // проверка существования файла
//    if opendialog1.execute then memo1.Lines.LoadFromFile(opendialog1.file)
    Memo1.Lines.LoadFromFile( ExtractFilePath(ParamStr(0))+'Data\TaskList.txt' )
  end;
end;

// Сохранить содержимое Memo1 в файл
procedure TForm5.Button2Click(Sender: TObject);
begin
//  ListBox1.Items.SaveToFile( ExtractFilePath(ParamStr(0))+'Data\TaskList.txt' );
//if SaveDialog1.Execute then
//  Memo1.Lines.SaveToFile(SaveDialog1.FileName+'.txt');
  if Application.MessageBox('Вы уверены, что хотите записать в файл этот список задач ?', 'Внимание', MB_ICONQUESTION+MB_YESNO+MB_DEFBUTTON2)=idYes then
    Memo1.Lines.SaveToFile( ExtractFilePath(ParamStr(0))+'Data\TaskList.txt' );
end;

procedure TForm5.Button3Click(Sender: TObject);
begin
  // Вывод запроса на подтверждение очистки списка
// MessageBox(handle, PChar('текст'),PChar('заголовок'), MB_ICONSTOP+MB_YESNOCANCEL+MB_DEFBUTTON2);
  if Application.MessageBox('Вы уверены, что хотите очистить список ?', 'Внимание', MB_ICONQUESTION+MB_YESNO+MB_DEFBUTTON2)=idYes then
    Memo1.Clear;
end;

procedure TForm5.Button4Click(Sender: TObject);
begin
  // Сформируем список для выбора значений в поле 'Задача' (2-я колонка, нумерация с 0)
  // Список часто выполняемых задач занесем в текстовый файл с именем TaskList.txt,
  // расположенный в подкаталоге Data\ и этот список занесем в список вариантов выбора значений поля 'Задача'
  if FileExists( ExtractFilePath(ParamStr(0))+'Data\TaskList.txt' ) then begin  // проверка существования файла
    // Подготовка файла к работе - объявление (назначение) файловой переменной (дескриптора файла)
    AssignFile(fd, ExtractFilePath(ParamStr(0))+'Data\TaskList.txt' );
    Reset(fd); // открываем текстовый файл для чтения
    while not Eof(fd) do begin // пока не достигнут конец файла
      ReadLn(fd, text); // читаем файл построчно в переменную text
      Form1.DBGrid1.Columns[2].PickList.   .Add(text); // добавляем значение в список выбора поля 'Задача'
    end;
    CloseFile(fd); // закрываем файл
  end;
end;

end.
